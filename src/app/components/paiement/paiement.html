<div class="paiement">
  <h2>Finaliser votre commande</h2>

  <div class="paiement-container">
    <div class="order-summary">
      <h3>Carte de la commande</h3>
      
      <div class="order-items">
        <div *ngFor="let item of cartItems" class="order-item">
          <img [src]="item.product.imageUrl" [alt]="item.product.name" class="order-item-image">
          <div class="order-item-info">
            <h4>{{ item.product.name }}</h4>
            <p>{{ item.product.brand }} - {{ item.product.volume }}</p>
            <p class="order-item-quantity">Quantit√©: {{ item.quantity }}</p>
          </div>
          <div class="order-item-price">
            {{ (item.product.price * item.quantity).toFixed(2) }} DT
          </div>
        </div>
      </div>

      <div class="order-total">
        <div class="total-line">
          <span>Sous-total</span>
          <span>{{ total.toFixed(2) }} DT</span>
        </div>
        <div class="total-line">
          <span>Livraison</span>
          <span>Gratuite</span>
        </div>
        <div class="total-line final">
          <span>Total</span>
          <span>{{ total.toFixed(2) }} DT</span>
        </div>
      </div>
    </div>

   
    <div class="payment-form">
      <form (ngSubmit)="onSubmit()" #paymentForm="ngForm">
       
        <div class="form-section">
          <h3>Informations de livraison</h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="nom">Nom *</label>
              <input 
                type="text" 
                id="nom" 
                name="nom" 
                [(ngModel)]="address.nom" 
                required
                placeholder="Votre nom">
            </div>
            
            <div class="form-group">
              <label for="prenom">Pr√©nom *</label>
              <input 
                type="text" 
                id="prenom" 
                name="prenom" 
                [(ngModel)]="address.prenom" 
                required
                placeholder="Votre pr√©nom">
            </div>
          </div>

          <div class="form-group">
            <label for="adresse">Adresse *</label>
            <input 
              type="text" 
              id="adresse" 
              name="adresse" 
              [(ngModel)]="address.adresse" 
              required
              placeholder="Num√©ro et nom de rue">
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="codePostal">Code postal *</label>
              <input 
                type="text" 
                id="codePostal" 
                name="codePostal" 
                [(ngModel)]="address.codePostal" 
                required
                placeholder="3400"
                pattern="[0-9]{5}">
            </div>
            
            <div class="form-group">
              <label for="ville">Ville *</label>
              <input 
                type="text" 
                id="ville" 
                name="ville" 
                [(ngModel)]="address.ville" 
                required
                placeholder="Tunis">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="telephone">T√©l√©phone *</label>
              <input 
                type="tel" 
                id="telephone" 
                name="telephone" 
                [(ngModel)]="address.telephone" 
                required
                placeholder="12 444 555"
                pattern="[0-9\s]{10,}">
            </div>
          </div>
        </div>

       
        <div class="form-section">
          <h3>M√©thode de paiement</h3>
          
          <div class="payment-methods">
            <label class="payment-method">
              <input 
                type="radio" 
                name="paymentMethod" 
                [(ngModel)]="paymentMethod" 
                value="livraison"
                required>
              <div class="payment-option">
                <span class="payment-icon">üöö</span>
                <div>
                  <strong>Paiement √† la livraison</strong>
                  <p>Payez en esp√®ces </p>
                </div>
              </div>
            </label>

            <label class="payment-method">
              <input 
                type="radio" 
                name="paymentMethod" 
                [(ngModel)]="paymentMethod" 
                value="carte"
                required>
              <div class="payment-option">
                <span class="payment-icon">üí≥</span>
                <div>
                  <strong>Paiement par carte</strong>
                  <p>Paiement s√©curis√© par carte bancaire</p>
                </div>
              </div>
            </label>
          </div>

          <div *ngIf="paymentMethod === 'carte'" class="card-details">
            <h4>Informations de carte bancaire</h4>
            
            <div class="form-group">
              <label for="numeroCarte">Num√©ro de carte *</label>
              <input 
                type="text" 
                id="numeroCarte" 
                name="numeroCarte" 
                [ngModel]="cardDetails.numeroCarte" 
                (input)="formatCardNumber($event)"
                required
                placeholder="1234 5678 9012 3456"
                maxlength="19"
                pattern="[0-9\s]{13,19}">
            </div>

            <div class="form-group">
              <label for="nomCarte">Nom sur la carte *</label>
              <input 
                type="text" 
                id="nomCarte" 
                name="nomCarte" 
                [ngModel]="cardDetails.nomCarte" 
                (input)="formatCardName($event)"
                required
                placeholder="NOM PRENOM"
                pattern="[A-Za-z\s]+">
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="dateExpiration">Date d'expiration *</label>
                <input 
                  type="text" 
                  id="dateExpiration" 
                  name="dateExpiration" 
                  [ngModel]="cardDetails.dateExpiration" 
                  (input)="formatExpirationDate($event)"
                  required
                  placeholder="MM/AA"
                  maxlength="5"
                  pattern="(0[1-9]|1[0-2])\/[0-9]{2}">
              </div>
              
              <div class="form-group">
                <label for="cvv">CVV *</label>
                <input 
                  type="text" 
                  id="cvv" 
                  name="cvv" 
                  [ngModel]="cardDetails.cvv" 
                  (input)="formatCVV($event)"
                  required
                  placeholder="123"
                  maxlength="4"
                  pattern="[0-9]{3,4}">
              </div>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" routerLink="/cart" class="btn-back">
            ‚Üê Retour au panier
          </button>
          <button type="submit" class="btn-submit" [disabled]="!isFormValid()">
            Confirmer la commande
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

